define(["jquery","component/FormValidate","utils","./scrollTable"],function(a,b,c){var d={"click [data-mode]":function(a){a.preventDefault(),a.stopPropagation(),this._mode(a.currentTarget.getAttribute("data-mode"))},"click .btn-confirm":function(a){a.preventDefault(),a.stopPropagation(),this._done(!0)},"click .btn-cancle":function(a){a.preventDefault(),a.stopPropagation(),this._done(!1)}},e={prefix:"",selectElement:!1,selectLen:1,modify:{options:{url:function(a,b){return b+"/modify"},data:!0,method:"POST",processData:!1},validate:null},upload:{options:{url:function(a,b){return b+"/add"},data:!0,method:"POST",processData:!1},validate:null},"delete":{options:{url:function(a,b){return b+"/delete/"+a.id},method:"GET"}},init:a.noop};proto=a.extend({},{version:"1.1",options:e,_extend:a.noop,_create:function(){this._super();var b=this,c=this.options,e=this.modeData={},f=this.modeElements={};a.each(["view","upload","modify"],function(a,c){f[c]=b.find("."+c).addClass("ui-scrollTable-"+c)}),this.loadingImg=a('<img src="/img/loading.gif" width="30" height="30" />'),this.element.prepend('<div class="controller"><a href="#" data-mode="upload"><i class="fa fa-plus-square"></i>추가</a></div>'),a.each(this._modes,function(a,d){d.create&&d.create.call(b,d,c[a],f[a],e[a]={})}),this._on(d),this._mode()},_init:function(){this._done(!1),this._super()},refresh:function(){this._done(!1)},fetch:function(){var a;return this._mode("fetch"),a=this.deferred.ajaxPromise.done(this.options.fetchAfterHandler),this._done(!0),a},remove:function(b){var c,d=this.options.removeHandler.call(this,this.getItem(b),b);if(d!==!1)return this.currentId=b,this._mode("delete"),c=this.deferred.ajaxPromise,this._done(!0),a.isPlainObject(d)&&a.each(["done","fail"],function(b,e){c[e](d[e]||a.noop)}),c},_selectedOn:function(a){this._superApply(arguments)&&(this.currentId=a,this._mode("view"))},_selectedOff:function(a){this._superApply(arguments),this._mode()},block:function(a){return a?this._super(this.loadingImg):this._super(),this}},{_mode:function(a){var b,c=this._modes[a];return this._done(!1),this.status=a,b=this._viewControll(a),c&&(c.init&&c.init.call(this,this.currentId,b,this.modeData[a]),this.deferred=this._deferred()),this},_viewControll:function(b){return a.each(this.modeElements,function(a,c){c.hasClass("ui-scrollTable-"+b)?c.removeClass("ui-helper-hidden"):c.addClass("ui-helper-hidden")}),this.modeElements[b]},_modes:{fetch:{done:function(a){this.clear(),this.addList(a)}},"delete":{done:function(a){this._mode(),this._init(),this.fetch()}},view:{init:function(a,b){var d=this.getItem(a),e=c.dataConvert();b.find("[data-type]").each(function(a,b){b.textContent=e(d,[b.getAttribute("data-type")])})},cancle:function(a,b){this._isFull()&&this._selectedOff(this.currentId)}},modify:{create:function(c,d,e,f){var g=this,h={beforeCommit:function(){return g._done(!0),!1}};f.validate=b(e,a.extend({},d.validate,h))},init:function(a,b,c){var d=this.getItem(a),e=this.options.prefix+"/modify/"+d.id;this._remote({url:e}).success(function(a){c.validate.initValue(a)})},preAjax:function(a,b,c){var d=c.validate;return d.validate()?d.serialize():!1},done:function(){this._mode(),this._init(),this.fetch()},cancle:function(a,b,c){this._viewControll(!1)}},upload:{create:function(c,d,e,f){var g=this,h={beforeCommit:function(){return g._done(!0),!1}};f.validate=b(e,a.extend({},d.validate,h))},init:function(a,b,c){c.validate._init()},preAjax:function(a,b,c){var d=c.validate;return d.validate()?d.serialize():!1},done:function(){this._mode(),this._init(),this.fetch()},cancle:function(){this._viewControll(!1)}}}},{_done:function(a){var b,c,d=this;if(void 0===a)return this.deferred=void 0;if(b=this.deferred)if(this.deferred=void 0,a){if(b.intercept&&!(c=b.intercept.call(d)))return void(this.deferred=b);b.resolve(c)}else b.reject();return this},_deferred:function(){var b=this,c=this.status,d=this.options[c],e=this.modeData[c],f=[this.currentId,this.modeElements[c],e],g=this._modes[c],h=a.Deferred().fail(function(){g.cancle.apply(b,f)});return h.name=c,g.preAjax&&(h.intercept=function(){return g.preAjax.apply(b,f)}),h.ajaxPromise=h.then(function(d){var e=a.extend({},b.options[c].options);return e.url=a.isFunction(e.url)?e.url.call(b,b.getItem(f[0]),b.options.prefix):e.url,e.data=d,b._remote.call(b,e,b.options[c].handlers)}).done(g.done).done(d&&d.afterHandler||a.noop),h},_remote:function(b,c){var d,e,f=this;return this.block(!0),e=a.extend({context:f},b),d=a.ajax(e),a.each(c||[],function(a,b){d[a](function(){b.apply(this,arguments)})}),d.promise().done(function(){f.block(!1)}),d}});a.widget("ui.scrollTableAjax",a.ui.scrollTable,proto)});
//# sourceMappingURL=scrollTable-ajax.js.map